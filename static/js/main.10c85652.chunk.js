(this["webpackJsonpdrawing-sample"]=this["webpackJsonpdrawing-sample"]||[]).push([[0],{124:function(e,t,n){"use strict";n.r(t);var r,c,a,i,o,s=n(0),l=n.n(s),u=n(29),b=n.n(u),d=n(95),j=n(184),f=n(174),O=n(4),v=n(55),h=n.n(v),x=new h.a(1,0),p=new h.a(0,1),g=function(e,t,n){if(n>=1)return t;if(n<=0)return e;var r=t.clone().subtract(e).normalize(),c=e.distance(t),a=r.multiplyScalar(c*n);return e.clone().add(a)},m=function(e,t){var n=t.clone().subtract(e).normalize(),r=new h.a(n.y,-1*n.x).normalize();return p.dot(r)>0&&r.invert(),r},y=function(e){return JSON.parse(JSON.stringify(e))},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t),r=Math.round(e*n)/n;return r},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25,n=e/t,r=Math.round(n)*t;return r},k=function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1],c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return[w(n,c),w(r,c)]},S=n(5),I=n(180),E=function(e,t){return{id:Object(I.a)(),x:e,y:t}},z=["free","pin","pinX","pinZ","fixX","fix"],N=function(e){if(e&&"object"===typeof e){var t=e;return"string"===typeof t.id&&"number"===typeof t.x&&"number"===typeof t.y}return!1},M=function(e){if(e&&"object"===typeof e){var t=e;return"string"===typeof t.id&&"string"===typeof t.name&&"string"===typeof t.beam&&"number"===typeof t.force&&"number"===typeof t.distanceI}return!1},P=function(e){if(e&&"object"===typeof e){var t=e;return"string"===typeof t.id&&"string"===typeof t.name&&"string"===typeof t.beam&&"number"===typeof t.forceI&&"number"===typeof t.distanceI&&"number"===typeof t.forceJ&&"number"===typeof t.distanceJ}return!1},D={unit:{force:"kN",length:"m"},nodes:[],beams:[],forces:[],trapezoids:[]},R=["select","edit"],T={A3:{width:0,height:0},A4:{width:2970,height:2100},B4:{width:0,height:0},B5:{width:0,height:0}},_={width:160,height:90},W={stroke:"#000000",strokeWidth:4,eraser:!1,lineJoin:"round",lineCap:"round"},B={size:"A4",drawings:[],structures:[Object(S.a)({data:D,x:100,y:100},_)]},A=n(1),J=Object(s.createContext)(void 0),F=function(e){var t=e.children,n=Object(s.useState)("note"),r=Object(O.a)(n,2),c=r[0],a=r[1],i=Object(s.useState)(B),o=Object(O.a)(i,2),l=o[0],u=o[1],b=Object(s.useState)(),d=Object(O.a)(b,2),j=d[0],f=d[1],v=Object(s.useState)(),h=Object(O.a)(v,2),x=h[0],p=h[1],g=Object(s.useRef)(null),m=Object(s.useCallback)((function(e){a("canvas"),p(e)}),[]),C=Object(s.useCallback)((function(){if(g.current){var e=g.current.getStructure(),t=g.current.toDataURL();"number"===typeof j&&u((function(n){var r=y(n);return r.structures[j].data=e,r.structures[j].image=t,r}))}a("note"),p(void 0)}),[j]);return Object(A.jsx)(J.Provider,{value:{mode:c,onChangeMode:a,page:l,onChange:u,selectedCanvasIndex:j,onSelectCanvas:f,canvasProps:x,editCanvas:m,closeCanvas:C,canvasRef:g},children:t})},X=Object(s.createContext)(void 0),G=function(e){var t=e.children,n=Object(s.useState)("select"),r=Object(O.a)(n,2),c=r[0],a=r[1];return Object(A.jsx)(X.Provider,{value:{tool:c,setTool:a},children:t})},L=Object(s.createContext)(void 0),Y=function(e){var t=e.children,n=Object(s.useState)("select"),r=Object(O.a)(n,2),c=r[0],a=r[1],i=Object(s.useState)(W),o=Object(O.a)(i,2),l=o[0],u=o[1];return Object(A.jsx)(L.Provider,{value:{mode:c,settings:l,onChangeMode:a,onChangeDrawSettings:u},children:t})},U=n(192),Z=n(186),V=n(188),H=n(185),q=null!==(r=null===(c="38d367377b1a5491632cd31f095fe5c11a15fd14\n")?void 0:c.substring(0,7))&&void 0!==r?r:"",K=null!==(a="2022/01/13 11:34:41")?a:"",Q=null!==(i="0.1.0")?i:"",$=function(){return Object(A.jsx)(H.a,{variant:"caption",sx:{ml:2},children:"ver ".concat(Q," (").concat(q,": ").concat(K,")")})},ee=function(){return Object(A.jsx)(Z.a,{position:"static",children:Object(A.jsxs)(V.a,{variant:"dense",children:[Object(A.jsx)(H.a,{component:"h1",variant:"h6",color:"inherit",children:"Drawing Sample"}),Object(A.jsx)($,{})]})})},te=n(18),ne=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=l.a.useRef([]);return r.current=t.map((function(e){return l.a.useContext(e)})),l.a.useMemo((function(){return function(e){var n=e.children;return t.reduceRight((function(e,t,n){return Object(A.jsx)(t.Provider,{value:r.current[n],children:e})}),n)}}),[t])},re=n(19),ce=Object(s.createContext)(void 0),ae=function(e){var t=e.children,n=e.structure,r=e.size,c=e.gridSize,a=void 0===c?25:c,i=e.snapSize,o=void 0===i?25:i,l=e.tool,u=void 0===l?"select":l,b=e.readonly,d=void 0!==b&&b,j=Object(s.useState)([]),f=Object(O.a)(j,2),v=f[0],h=f[1],x=Object(s.useState)([]),p=Object(O.a)(x,2),g=p[0],m=p[1],C=Object(s.useState)([]),w=Object(O.a)(C,2),k=w[0],E=w[1],z=Object(s.useState)(0),D=Object(O.a)(z,2),R=D[0],T=D[1],_=Object(s.useState)([]),W=Object(O.a)(_,2),B=W[0],J=W[1],F=Object(s.useState)([]),X=Object(O.a)(F,2),G=X[0],L=X[1];Object(s.useEffect)((function(){var e=n.nodes,t=n.beams,r=n.forces,c=n.trapezoids;h(e),m(t),E(r),J(c)}),[n]);var Y=Object(s.useCallback)((function(){return{unit:n.unit,nodes:v,beams:g,forces:k,trapezoids:B}}),[g,k,v,n.unit,B]);Object(s.useEffect)((function(){var e=0;k.length>0&&(e=k.reduce((function(e,t){return Object(S.a)(Object(S.a)({},e),{},{force:e.force+t.force})})).force/k.length);T(e)}),[k]);var U=Object(s.useMemo)((function(){var e={};return v.forEach((function(t){e[t.id]=t})),e}),[v]),Z=Object(s.useMemo)((function(){var e={};return g.forEach((function(t){e[t.id]=t})),e}),[g]),V=Object(s.useCallback)((function(e){d||h((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e.id}));if(r>=0){var c=n[r];n[r]=Object(S.a)(Object(S.a)({},c),e)}return n}))}),[d]),H=Object(s.useCallback)((function(e){if(!d){var t=[];Array.isArray(e)?t.push.apply(t,Object(re.a)(e)):t.push(e);var n=[];t.forEach((function(e){"undefined"===typeof e.id&&(e.id=Object(I.a)()),N(e)&&n.push(e)})),h((function(e){return[].concat(Object(re.a)(e),n)}))}}),[d]),q=Object(s.useCallback)((function(e){d||(m((function(t){for(var n=y(t),r=n.findIndex((function(t){var n=t.nodeI,r=t.nodeJ;return n===e||r===e}));r>=0;)n.splice(r,1),r=n.findIndex((function(t){var n=t.nodeI,r=t.nodeJ;return n===e||r===e}));return n})),h((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e}));return r>=0&&n.splice(r,1),n})))}),[d]),K=Object(s.useCallback)((function(e){d||m((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e.id}));if(r>=0){var c=n[r];n[r]=Object(S.a)(Object(S.a)({},c),e)}return n}))}),[d]),Q=Object(s.useCallback)((function(e){if(!d){var t=Object(S.a)({},e);"undefined"===typeof t.id&&(t.id=Object(I.a)()),function(e){if(e&&"object"===typeof e){var t=e;return"string"===typeof t.id&&"string"===typeof t.name&&"string"===typeof t.nodeI&&"string"===typeof t.nodeJ}return!1}(t)&&m((function(e){return[].concat(Object(re.a)(e),[t])}))}}),[d]),$=Object(s.useCallback)((function(e){if(!d){var t=g.find((function(t){return t.id===e}));if(t){var n=t.nodeI,r=t.nodeJ,c=new Set;g.forEach((function(t){var n=t.id,r=t.nodeI,a=t.nodeJ;n!==e&&(c.add(r),c.add(a))})),h((function(e){var t=y(e);return[n,r].forEach((function(e){if(!c.has(e)){var n=t.findIndex((function(t){return t.id===e}));n>=0&&t.splice(n,1)}})),t}))}E((function(t){for(var n=y(t),r=n.findIndex((function(t){return t.beam===e}));r>=0;)n.splice(r,1),r=n.findIndex((function(t){return t.beam===e}));return n})),J((function(t){for(var n=y(t),r=n.findIndex((function(t){return t.beam===e}));r>=0;)n.splice(r,1),r=n.findIndex((function(t){return t.beam===e}));return n})),m((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e}));return r>=0&&n.splice(r,1),n}))}}),[g,d]),ee=Object(s.useCallback)((function(e){d||E((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e.id}));if(r>=0){var c=n[r];n[r]=Object(S.a)(Object(S.a)({},c),e)}return n}))}),[d]),te=Object(s.useCallback)((function(e){if(!d){var t=Object(S.a)({},e);"undefined"===typeof t.id&&(t.id=Object(I.a)()),M(t)&&E((function(e){return[].concat(Object(re.a)(e),[t])}))}}),[d]),ne=Object(s.useCallback)((function(e){d||E((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e}));return r>=0&&n.splice(r,1),n}))}),[d]),ae=Object(s.useCallback)((function(e){d||J((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e.id}));if(r>=0){var c=n[r];n[r]=Object(S.a)(Object(S.a)({},c),e)}return n}))}),[d]),ie=Object(s.useCallback)((function(e){if(!d){var t=Object(S.a)({},e);"undefined"===typeof t.id&&(t.id=Object(I.a)()),P(t)&&J((function(e){return[].concat(Object(re.a)(e),[t])}))}}),[d]),oe=Object(s.useCallback)((function(e){d||J((function(t){var n=y(t),r=n.findIndex((function(t){return t.id===e}));return r>=0&&n.splice(r,1),n}))}),[d]),se=Object(s.useCallback)((function(e){return G.some((function(t){var n=t.type,r=t.id;return n===e.type&&r===e.id}))}),[G]),le=Object(s.useCallback)((function(e){se(e)||L((function(t){return[].concat(Object(re.a)(t),[e])}))}),[se,L]),ue=Object(s.useCallback)((function(e){se(e)?L((function(t){return t.filter((function(t){var n=t.type,r=t.id;return!(n===e.type&&r===e.id)}))})):L((function(t){return[].concat(Object(re.a)(t),[e])}))}),[se,L]),be=Object(s.useCallback)((function(){L([])}),[]);return Object(A.jsx)(ce.Provider,{value:{size:r,gridSize:a,snapSize:o,tool:u,readonly:d,nodes:v,beams:g,forces:k,trapezoids:B,nodeMap:U,beamMap:Z,forceAverage:R,onChangeNode:V,onCreateNode:H,onDeleteNode:q,onChangeBeam:K,onCreateBeam:Q,onDeleteBeam:$,onChangeForce:ee,onCreateForce:te,onDeleteForce:ne,onChangeTrapezoid:ae,onCreateTrapezoid:ie,onDeleteTrapezoid:oe,selected:G,isSelected:se,select:le,toggleSelect:ue,clearSelection:be,getStructure:Y},children:t})},ie=["select","pen","force","trapezoid","delete"],oe=function(e){return!!Array.isArray(e)&&(0===e.length||e.every((function(e){return"number"===typeof e})))},se=Object(s.createContext)(void 0),le=function(e){var t=e.children,n=Object(s.useContext)(ce),r=n.tool,c=n.readonly,a=void 0!==c&&c,i=n.nodes,o=n.beams,l=n.trapezoids,u=n.onCreateNode,b=n.onCreateBeam,d=n.onCreateTrapezoid,j=Object(s.useState)([]),f=Object(O.a)(j,2),v=f[0],x=f[1],p=Object(s.useRef)(),g=Object(s.useRef)(),m=Object(s.useMemo)((function(){return!!a||!("pen"===r||"trapezoid"===r)}),[a,r]),y=Object(s.useCallback)((function(e){var t;if(!m){if("trapezoid"===r){if("beam"!==e.target.attrs.type)return;var n=e.target.attrs.id,c=e.target.attrs.points;oe(c)&&"string"===typeof n&&(g.current={id:n,points:c})}var a=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();a&&(p.current=!0,x([a.x,a.y]))}}),[m,r]),w=Object(s.useCallback)((function(e){var t;if(!m&&p.current){var n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();n&&x((function(e){return[].concat(Object(re.a)(e),[n.x,n.y])}))}}),[m]),S=Object(s.useCallback)((function(e,t){var n=k([e[0],e[1]],25),r=k([t[0],t[1]],25);if(n[0]!==r[0]||n[1]!==r[1]){var c=[],a={name:"Beam_".concat(o.length+1)};if(n[0]>r[0]){var s=[r,n];n=s[0],r=s[1]}else if(n[0]===r[0]&&n[1]>r[1]){var l=[r,n];n=l[0],r=l[1]}var d=E.apply(void 0,Object(re.a)(n)),j=i.find((function(e){return e.x===d.x&&e.y===d.y}));j?a.nodeI=j.id:(c.push(d),a.nodeI=d.id);var f=E.apply(void 0,Object(re.a)(r)),O=i.find((function(e){return e.x===f.x&&e.y===f.y}));O?a.nodeJ=O.id:(c.push(f),a.nodeJ=f.id),u(c),b(a)}}),[o.length,i,b,u]),z=Object(s.useCallback)((function(e,t,n){var r=function(e,t,n,r){var c=r.slice(0,2),a=r.slice(-2),i=new h.a(c[0],c[1]),o=new h.a(a[0],a[1]),s=i.distance(o),l=o.clone().subtract(i).normalize(),u=new h.a(e[0],e[1]),b=new h.a(t[0],t[1]),d=i.distance(u),j=i.distance(b);if(d>j){var f=[b,u];u=f[0],b=f[1];var O=[j,d];d=O[0],j=O[1]}var v=i.clone().add(l.clone().multiplyScalar(d)),x=b.clone().subtract(v).normalize(),p=l.angle()-x.angle(),g=v.distance(b)*Math.cos(p),m=v.clone().add(l.clone().multiplyScalar(g));j=o.distance(m);var y=C(d/s,3),w=C(j/s,3);return{id:Object(I.a)(),name:"Trapezoid_N",beam:n,forceI:10,forceJ:10,distanceI:y,distanceJ:w,angle:90,isGlobal:!1}}(e,t,n.id,n.points),c="Trapezoid_".concat(l.length+1);r.name=c,d(r)}),[d,l.length]),N=Object(s.useCallback)((function(e){if(!m&&p.current&&(p.current=!1,v.length>=4)){var t=v.slice(0,2),n=v.slice(-2);"pen"===r?S(t,n):"trapezoid"===r&&g.current&&z(t,n,g.current),x([]),g.current=void 0}}),[m,S,z,v,x,r]);return Object(A.jsx)(se.Provider,{value:{points:v,onPointerDown:y,onPointerMove:w,onPointerUp:N},children:t})},ue=function(){var e=Object(s.useContext)(ce).tool,t=Object(s.useContext)(se).points,n=Object(s.useMemo)((function(){switch(e){case"pen":return"blue";case"trapezoid":return"red";default:return"black"}}),[e]);return Object(A.jsx)(te.e,{children:Object(A.jsx)(te.f,{points:t,strokeWidth:3,stroke:n})})},be={id:"",points:[],stroke:"#c9e1ff",strokeWidth:1,dash:[5,3],listening:!1},de=function(){var e=Object(s.useContext)(ce),t=e.size,n=e.gridSize,r=Object(s.useMemo)((function(){for(var e=[],r=1,c=0;c<=t.height;c+=n)e.push(Object(S.a)(Object(S.a)({},be),{},{id:"Horizontal_".concat(r),points:[0,c,t.width,c]})),r++;return e}),[n,t.height,t.width]),c=Object(s.useMemo)((function(){for(var e=[],r=1,c=0;c<=t.width;c+=n)e.push(Object(S.a)(Object(S.a)({},be),{},{id:"Vertical_".concat(r),points:[c,0,c,t.height]})),r++;return e}),[n,t.height,t.width]);return Object(A.jsxs)(te.e,{listening:!1,children:[r.map((function(e){return Object(A.jsx)(te.f,Object(S.a)({},e),e.id)})),c.map((function(e){return Object(A.jsx)(te.f,Object(S.a)({},e),e.id)}))]})},je=function(e,t){var n=e.id,r=e.name,c=e.nodeI,a=e.nodeJ,i=e.points,o=e.selected,l=void 0!==o&&o,u=e.onClick,b=Object(s.useState)([0,0]),d=Object(O.a)(b,2),j=d[0],f=d[1],v=Object(s.useState)(0),x=Object(O.a)(v,2),p=x[0],g=x[1],y=Object(s.useState)(0),C=Object(O.a)(y,2),w=C[0],k=C[1],S=Object(s.useState)([[0,0],[0,0]]),I=Object(O.a)(S,2),E=I[0],z=I[1],N=Object(s.useRef)(new h.a(0,0)),M=Object(s.useRef)(new h.a(0,0));return Object(s.useEffect)((function(){if(l){var e=Object(O.a)(i,4),t=e[0],n=e[1],r=e[2],c=e[3];N.current.x=t,N.current.y=n,M.current.x=r,M.current.y=c;var a=N.current,o=M.current;if(a.x>o.x){var s=[o,a];a=s[0],o=s[1]}var u=a.distance(o),b=m(a,o),d=a.clone().add(b.clone().multiplyScalar(16)),j=o.clone().subtract(a).angleDeg(),v=b.clone().multiplyScalar(75),h=a.clone().add(v),x=o.clone().add(v);g(u),f([d.x,d.y]),k(j),z([[h.x,h.y],[x.x,x.y]])}}),[i,l]),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(te.f,{ref:t,type:"beam",id:n,name:r,nodeI:c,nodeJ:a,points:i,stroke:l?"blue":"black",strokeWidth:4,onClick:u,onTap:u}),l&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(te.i,{x:j[0],y:j[1],rotation:w,text:r,fontSize:12,width:p,fill:"blue",align:"center",wrap:"none",ellipsis:!0,listening:!1}),Object(A.jsx)(xe,{start:E[0],end:E[1]})]})]})},fe=Object(s.forwardRef)(je),Oe=function(e){var t=e.points,n=e.id,r=e.distanceI,c=e.force,a=e.ratio,i=e.visible,o=void 0!==i&&i,l=e.selected,u=void 0!==l&&l,b=e.onClick,d=e.onDblClick,j=Object(s.useState)([]),f=Object(O.a)(j,2),v=f[0],p=f[1],y=Object(s.useState)(0),C=Object(O.a)(y,2),w=C[0],k=C[1],S=Object(s.useState)(0),I=Object(O.a)(S,2),E=I[0],z=I[1],N=Object(s.useState)([0,0]),M=Object(O.a)(N,2),P=M[0],D=M[1],R=Object(s.useRef)(new h.a(0,0)),T=Object(s.useRef)(new h.a(0,0));Object(s.useEffect)((function(){var e=Object(O.a)(t,4),n=e[0],c=e[1],i=e[2],o=e[3];R.current.x=n,R.current.y=c,T.current.x=i,T.current.y=o;var s=g(R.current,T.current,r),l=m(R.current,T.current),u=isNaN(a)?30:30*a,b=s.clone().add(l.multiplyScalar(u));p([b.x,b.y,s.x,s.y]),k(Math.max(u,140));var d=l.clone().angleDeg();z(d);var j=R.current.clone().subtract(T.current).normalize();x.dot(j)<0&&j.invert();var f=s.clone().add(j.multiplyScalar(6));D([f.x,f.y])}),[t,r,a]);var _=Object(s.useMemo)((function(){return u?"red":"orange"}),[u]);return Object(A.jsxs)(te.c,{type:"force",id:n,visible:o,onClick:b,onTap:b,onDblClick:d,onDblTap:d,children:[Object(A.jsx)(te.a,{points:v,pointerLength:6,pointerWidth:6,fill:_,stroke:_,strokeWidth:2}),u&&Object(A.jsx)(te.i,{x:P[0],y:P[1],offsetX:-6,text:"".concat(c,"kN"),fontSize:12,width:w,rotation:E,fill:_,wrap:"none",ellipsis:!0})]})},ve={fill:"silver",stroke:"silver",strokeWidth:1,listening:!1},he=Object(S.a)({pointerLength:6,pointerWidth:6,pointerAtBeginning:!0},ve),xe=function(e){var t=e.start,n=e.end,r=Object(s.useRef)(new h.a(0,0)),c=Object(s.useRef)(new h.a(0,0)),a=Object(s.useState)(0),i=Object(O.a)(a,2),o=i[0],l=i[1],u=Object(s.useState)(0),b=Object(O.a)(u,2),d=b[0],j=b[1],f=Object(s.useState)([0,0]),v=Object(O.a)(f,2),x=v[0],p=v[1];return Object(s.useEffect)((function(){r.current.x=t[0],r.current.y=t[1],c.current.x=n[0],c.current.y=n[1];var e=r.current.distance(c.current),a=c.current.clone().subtract(r.current).normalize().angleDeg();l(Math.round(e)),j(90===a?-90:a),p(90===a?n:t)}),[n,t]),Object(A.jsxs)(te.c,{x:x[0],y:x[1],rotation:d,children:[Object(A.jsx)(te.f,Object(S.a)({points:[0,0,0,10]},ve)),Object(A.jsx)(te.a,Object(S.a)({points:[0,5,o,5]},he)),Object(A.jsx)(te.f,Object(S.a)({points:[o,0,o,10]},ve)),Object(A.jsx)(te.i,{x:0,y:-8,text:"".concat(o,"px"),fontSize:12,fill:"silver",width:o,align:"center",listening:!1,wrap:"none",ellipsis:!0})]})},pe=n(44),ge=n.n(pe),me={free:"/assets/images/pins/pin_1.svg",pin:"/assets/images/pins/pin_1.svg",pinX:"/assets/images/pins/pin_2.svg",pinZ:"/assets/images/pins/pin_2.svg",fixX:"/assets/images/pins/pin_3.svg",fix:"/assets/images/pins/pin_4.svg"},ye=function(e,t){var n=e.id,r=e.x,c=e.y,a=e.pin,i=e.draggable,o=void 0!==i&&i,l=e.isDragging,u=void 0!==l&&l,b=e.onDblClick,d=e.onDragStart,j=e.onDragMove,f=e.onDragEnd,v=Object(s.useMemo)((function(){return"".concat("/drawing-sample").concat(me[null!==a&&void 0!==a?a:"free"])}),[a]),h=ge()(v),x=Object(O.a)(h,1)[0],p=Object(s.useCallback)((function(e){e.cancelBubble=!0}),[]);return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(te.b,{ref:t,type:"node",id:n,x:r,y:c,pin:a,fill:u?"blue":"black",radius:4,draggable:o,onDragStart:d,onDragMove:j,onDragEnd:f,onClick:p,onTap:p,onDblClick:b,onDblTap:b,_useStrictMode:!0}),!u&&a&&"free"!==a&&Object(A.jsx)(te.d,{x:r,y:c,offsetX:12,offsetY:-4,rotation:"pinZ"===a?-90:0,image:x,width:24,height:24,listening:!1})]})},Ce=Object(s.forwardRef)(ye),we={stroke:"pink",strokeWidth:2},ke=Object(S.a)({pointerLength:6,pointerWidth:6,fill:"pink"},we),Se={offsetX:-6,offsetY:14,fontSize:12,wrap:"none",ellipsis:!0},Ie=function(e){var t=e.points,n=e.id,r=e.beam,c=e.forceI,a=e.forceJ,i=e.distanceI,o=e.distanceJ,l=e.angle,u=void 0===l?90:l,b=e.isGlobal,d=void 0!==b&&b,j=e.visible,f=void 0!==j&&j,v=e.selected,p=void 0!==v&&v,m=e.onClick,y=e.onDblClick,C=Object(s.useState)([]),w=Object(O.a)(C,2),k=w[0],I=w[1],E=Object(s.useState)([0,0,0,0]),z=Object(O.a)(E,2),N=z[0],M=z[1],P=Object(s.useState)(),D=Object(O.a)(P,2),R=D[0],T=D[1],_=Object(s.useState)(),W=Object(O.a)(_,2),B=W[0],J=W[1],F=Object(s.useState)([[0,0],[0,0]]),X=Object(O.a)(F,2),G=X[0],L=X[1],Y=Object(s.useRef)(new h.a(0,0)),U=Object(s.useRef)(new h.a(0,0));Object(s.useEffect)((function(){var e=Y.current,n=U.current,r=Object(O.a)(t,4),s=r[0],l=r[1],b=r[2],j=r[3];e.x=s,e.y=l,n.x=b,n.y=j;var f,v=n.clone().subtract(e).normalize();f=d?x.clone().rotateDeg(-1*u):v.clone().rotateDeg(-1*u).normalize();var h=e.distance(n),p=e.clone().add(v.clone().multiplyScalar(h*i)),m=n.clone().add(v.clone().invert().multiplyScalar(h*o)),y=p.clone().add(f.clone().multiplyScalar(10*c)),C=m.clone().add(f.clone().multiplyScalar(10*a)),w=function(e,t,n){for(var r=[],c=e.distance(t),a=10,i=c/(a+1);i<25&&a>0;)i=c/(1+--a);if(a>0)for(var o=1;o<=a;o++){var s=e.clone().add(n.clone().multiplyScalar(i*o));r.push(s)}else if((i=c/2)>=10){var l=g(e,t,.5);r.push(l)}return r}(p,m,v),k=C.x-y.x!==0?(C.y-y.y)/(C.x-y.x):NaN,S=isNaN(k)?NaN:y.y-k*y.x,E=[];w.forEach((function(e){var t=function(e,t,n){var r=Object(O.a)(e,4),c=r[0],a=r[1],i=r[2],o=r[3],s=null;try{var l=t.clone().add(n),u=l.x-t.x!==0?(l.y-t.y)/(l.x-t.x):NaN,b=isNaN(u)?NaN:t.y-u*t.x;if(i===u)return null;if(isNaN(i)||isNaN(u)){if(isNaN(i)){var d=c.x;s=[d,d*u+b]}else if(isNaN(u)){var j=t.x;s=[j,j*i+o]}}else{var f=(b-o)/(i-u);s=[f,i*f+o]}if(s){var v=s,h=Object(O.a)(v,2),x=h[0],p=h[1],g=[c.x,a.x].sort((function(e,t){return e-t})),m=[c.y,a.y].sort((function(e,t){return e-t}));if(x>=g[0]&&x<=g[1]&&p>=m[0]&&p<=m[1])return s}return null}catch(y){console.error(y)}return null}([y,C,k,S],e,f);if(t){var n=[t[0],t[1],e.x,e.y];E.push(n)}}));var z=f.angleDeg();T({x:p.x,y:p.y,text:"".concat(c,"kN/m"),width:p.distance(y),rotation:z}),J({x:m.x,y:m.y,text:"".concat(a,"kN/m"),width:m.distance(C),rotation:z});var N=10*Math.max(c,a),P=f.clone().multiplyScalar(N+50),D=p.clone().add(P),R=m.clone().add(P);L([[D.x,D.y],[R.x,R.y]]),M([y.x,y.y,C.x,C.y]),I([[y.x,y.y,p.x,p.y]].concat(E,[[C.x,C.y,m.x,m.y]]))}),[u,t,i,o,c,a,d]);var Z=Object(s.useMemo)((function(){return p?"red":"pink"}),[p]);return Object(A.jsxs)(te.c,{type:"trapezoid",id:n,beam:r,visible:f,onClick:m,onTap:m,onDblClick:y,onDblTap:y,children:[Object(A.jsx)(te.f,Object(S.a)(Object(S.a)({points:N},we),{},{stroke:Z})),k.map((function(e,t){return Object(A.jsx)(te.a,Object(S.a)(Object(S.a)({points:e},ke),{},{stroke:Z,fill:Z}),"arrow_".concat(t))})),p&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(te.i,Object(S.a)(Object(S.a)(Object(S.a)({},Se),R),{},{fill:Z})),Object(A.jsx)(te.i,Object(S.a)(Object(S.a)(Object(S.a)({},Se),B),{},{fill:Z})),Object(A.jsx)(xe,{start:G[0],end:G[1]})]})]})},Ee=25,ze=function(){var e=Object(s.useContext)(ce).nodes,t=Object(s.useMemo)((function(){var t={maxX:Number.MIN_SAFE_INTEGER,minX:Number.MAX_SAFE_INTEGER,guidesX:[],maxY:Number.MIN_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,guidesY:[]},n=new Set,r=new Set;if(e.forEach((function(e){var c=e.x,a=e.y;t.maxX<c&&(t.maxX=c),t.minX>c&&(t.minX=c),n.has(c)||n.add(c),t.maxY<a&&(t.maxY=a),t.minY>a&&(t.minY=a),r.has(a)||r.add(a)})),n.size>1)for(var c=Array.from(n).sort((function(e,t){return e<t?-1:1})),a=c[0],i=1;i<c.length;i++){var o=c[i],s={key:"LocalGuideX_".concat(i),start:[a,t.maxY+100],end:[o,t.maxY+100]};a=o,t.guidesX.push(s)}if(r.size>1)for(var l=Array.from(r).sort((function(e,t){return e<t?-1:1})),u=l[0],b=Math.max(t.minX-100,50),d=1;d<l.length;d++){var j=l[d],f={key:"LocalGuideY_".concat(d),start:[b,u],end:[b,j]};u=j,t.guidesY.push(f)}return t}),[e]),n=t.minX,r=t.maxX,c=t.guidesX,a=t.minY,i=t.maxY,o=t.guidesY,l=Object(s.useMemo)((function(){return n!==Number.MAX_SAFE_INTEGER?Math.max(Ee,n-125):0}),[n]),u=Object(s.useMemo)((function(){return i!==Number.MIN_SAFE_INTEGER?i+125:0}),[i]);return Object(A.jsxs)(te.e,{listening:!1,children:[n!==Number.MAX_SAFE_INTEGER&&r!==Number.MIN_SAFE_INTEGER&&Object(A.jsx)(xe,{start:[n,u],end:[r,u]}),c.map((function(e){return Object(A.jsx)(xe,Object(S.a)({},e))})),a!==Number.MAX_SAFE_INTEGER&&i!==Number.MIN_SAFE_INTEGER&&Object(A.jsx)(xe,{start:[l,a],end:[l,i]}),o.map((function(e){return Object(A.jsx)(xe,Object(S.a)({},e))}))]})},Ne=Object(s.createContext)(void 0),Me=function(e){var t=e.children,n=Object(s.useState)(),r=Object(O.a)(n,2),c=r[0],a=r[1],i=Object(s.useState)({top:0,left:0}),o=Object(O.a)(i,2),l=o[0],u=o[1],b=Object(s.useState)({}),d=Object(O.a)(b,2),j=d[0],f=d[1],v=Object(s.useCallback)((function(e,t,n){a(e),u(t),n&&f(n)}),[u,a]),h=Object(s.useCallback)((function(){a(void 0),u({top:0,left:0}),f({})}),[u,a]);return Object(A.jsx)(Ne.Provider,{value:{popupType:c,setPopupType:a,popupPosition:l,setPopupPosition:u,open:v,close:h,popupParams:j},children:t})},Pe=function(){var e=Object(s.useContext)(ce),t=e.tool,n=e.readonly,r=e.nodes,c=e.nodeMap,a=e.beams,i=e.beamMap,o=e.forces,l=e.forceAverage,u=e.trapezoids,b=e.snapSize,d=e.onChangeNode,j=e.onCreateForce,f=e.onDeleteBeam,v=e.onDeleteForce,x=e.onDeleteTrapezoid,p=e.select,g=e.isSelected,m=Object(s.useContext)(Ne).open,y=Object(s.useRef)([]),w=Object(s.useRef)([]),I=Object(s.useRef)(null);Object(s.useEffect)((function(){y.current=y.current.slice(0,r.length)}),[r.length]),Object(s.useEffect)((function(){w.current=w.current.slice(0,a.length)}),[a.length]);var E=Object(s.useState)(),z=Object(O.a)(E,2),N=z[0],M=z[1],P=Object(s.useMemo)((function(){return!n&&"select"===t}),[n,t]),D=Object(s.useRef)(new h.a(0,0)),R=Object(s.useRef)(),T=Object(s.useCallback)((function(e,t){var n=c[e],r=c[t];return[n.x,n.y,r.x,r.y]}),[c]),_=Object(s.useCallback)((function(e){var t=i[e];return T(t.nodeI,t.nodeJ)}),[i,T]),W=Object(s.useCallback)((function(e){var n,r=!1;if("select"===t)p({type:"beams",id:e.target.id()}),r=!0;else if("delete"===t)f(e.target.id()),r=!0;else if("force"===t){var c,a=null===(c=e.target.getStage())||void 0===c?void 0:c.getPointerPosition(),i=e.target.attrs.points;if(a&&(oe(n=i)&&4===n.length)){var s=function(e,t,n,r){var c=t.distance(n),a=t.distance(r);return{beam:e,force:10,distanceI:C(a/c)}}(e.target.id(),new h.a(i[0],i[1]),new h.a(i[2],i[3]),new h.a(a.x,a.y)),l="Force_".concat(o.length);j(Object(S.a)(Object(S.a)({},s),{},{name:l})),r=!0}}e.cancelBubble=r}),[o.length,j,f,p,t]),B=Object(s.useCallback)((function(e){if("select"===t){var n,c=null===(n=e.target.getStage())||void 0===n?void 0:n.getPointerPosition(),a=r.find((function(t){return t.id===e.target.id()}));c&&a&&m("nodes",{top:c.y,left:c.x},a)}}),[r,m,t]),J=Object(s.useCallback)((function(){if(N){var e=D.current,t=e.x,n=e.y;w.current.forEach((function(e){if(e){var r=e.attrs,c=r.nodeI,a=r.nodeJ,i=e.points();c===N&&e.points([t,n,i[2],i[3]]),a===N&&e.points([i[0],i[1],t,n])}}))}}),[N]),F=Object(s.useCallback)((function(e){var t,n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();n&&(M(e.target.id()),D.current.x=n.x,D.current.y=n.y)}),[]);Object(s.useEffect)((function(){"undefined"!==typeof N&&(R.current&&clearInterval(R.current),R.current=setInterval(J,100))}),[N,J]);var X=Object(s.useCallback)((function(e){var t,n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();n&&(D.current.x=n.x,D.current.y=n.y)}),[]),G=Object(s.useCallback)((function(e){var t,n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();if(n){R.current&&clearInterval(R.current),D.current.x=0,D.current.y=0,M(void 0);var r=k([n.x,n.y],b),c=Object(O.a)(r,2),a=c[0],i=c[1];d({id:e.target.id(),x:a,y:i,pin:e.target.attrs.pin})}}),[d,b]),L=Object(s.useCallback)((function(e){var n=e.currentTarget.id(),r=!1;"select"===t?(p({type:"forces",id:n}),r=!0):"delete"===t&&(v(n),r=!0),e.cancelBubble=r}),[v,p,t]),Y=Object(s.useCallback)((function(e){if("select"===t){var n,r=null===(n=e.target.getStage())||void 0===n?void 0:n.getPointerPosition(),c=o.find((function(t){return t.id===e.currentTarget.id()}));r&&c&&m("forces",{top:r.y,left:r.x},c)}}),[o,m,t]),U=Object(s.useCallback)((function(e){var n=e.currentTarget.id(),r=!1;"select"===t?(p({type:"trapezoids",id:n}),r=!0):"delete"===t&&(x(n),r=!0),e.cancelBubble=r}),[x,p,t]),Z=Object(s.useCallback)((function(e){if("select"===t){var n,r=null===(n=e.target.getStage())||void 0===n?void 0:n.getPointerPosition(),c=u.find((function(t){return t.id===e.currentTarget.id()}));r&&c&&m("trapezoids",{top:r.y,left:r.x},c)}}),[m,t,u]);return Object(A.jsxs)(te.e,{ref:I,children:[a.map((function(e,t){return Object(A.jsx)(fe,Object(S.a)(Object(S.a)({ref:function(e){return w.current[t]=e}},e),{},{points:T(e.nodeI,e.nodeJ),selected:g({type:"beams",id:e.id}),onClick:W}),e.id)})),r.map((function(e,t){return Object(A.jsx)(Ce,Object(S.a)(Object(S.a)({ref:function(e){return y.current[t]=e}},e),{},{draggable:P,isDragging:N===e.id,onDblClick:B,onDragStart:F,onDragMove:X,onDragEnd:G}),e.id)})),o.map((function(e){return Object(A.jsx)(Oe,Object(S.a)(Object(S.a)({},e),{},{ratio:e.force/l,points:_(e.beam),visible:!Boolean(N),selected:g({type:"forces",id:e.id}),onClick:L,onDblClick:Y}),e.id)})),u.map((function(e){return Object(A.jsx)(Ie,Object(S.a)(Object(S.a)({},e),{},{points:_(e.beam),visible:!Boolean(N),selected:g({type:"trapezoids",id:e.id}),onClick:U,onDblClick:Z}),e.id)}))]})},De=n(31),Re=n(187),Te=n(165),_e=n(175),We=n(189),Be=n(182),Ae=["values"],Je=function(e){var t=e.force,n=e.onChange,r=e.onClose,c=Object(s.useState)(""),a=Object(O.a)(c,2),i=a[0],o=a[1],l=Object(s.useState)(),u=Object(O.a)(l,2),b=u[0],d=u[1],j=Object(s.useCallback)((function(e){if(e.preventDefault(),e.currentTarget.checkValidity()&&"undefined"===typeof b){var c=parseFloat(i);isNaN(c)||(n(Object(S.a)(Object(S.a)({},t),{},{force:c})),r())}}),[b,n,r,i,t]),f=Object(s.useCallback)((function(e){var t,n=e.currentTarget.value;o(n),0===n.length&&(t="\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044");var r=parseFloat(n);isNaN(r)&&(t="\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),(0>r||r>Number.MAX_SAFE_INTEGER)&&(t="0 \u3088\u308a\u5927\u304d\u3044\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),d(t)}),[]);return Object(s.useEffect)((function(){o("".concat(t.force)),d(void 0)}),[t]),Object(A.jsx)(Re.a,{children:Object(A.jsxs)(Te.a,{direction:"column",spacing:1,sx:{p:1,width:240},component:"form",autoComplete:"off",noValidate:!0,onSubmit:j,children:[Object(A.jsx)(_e.a,{variant:"outlined",margin:"dense",size:"small",label:"\u96c6\u4e2d\u8377\u91cd",value:i,required:!0,fullWidth:!0,onChange:f,InputProps:{endAdornment:Object(A.jsx)(We.a,{position:"end",children:"kN"})},error:Boolean(b),helperText:b}),Object(A.jsxs)(Te.a,{direction:"row",justifyContent:"flex-end",spacing:1,children:[Object(A.jsx)(Be.a,{size:"small",onClick:r,children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),Object(A.jsx)(Be.a,{type:"submit",size:"small",variant:"contained",children:"OK"})]})]})})},Fe=function(e){var t=e.values,n=Object(De.a)(e,Ae),r=Object(s.useMemo)((function(){return M(t)?t:{id:"",name:"",beam:"",force:0,distanceI:0}}),[t]);return Object(A.jsx)(Je,Object(S.a)(Object(S.a)({},n),{},{force:r}))},Xe=n(90),Ge=n.n(Xe),Le=n(98),Ye=n(183),Ue=n(190),Ze=["title","titleId"];function Ve(){return Ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ve.apply(this,arguments)}function He(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function qe(e,t){var n=e.title,r=e.titleId,c=He(e,Ze);return s.createElement("svg",Ve({id:"svg",viewBox:"0 0 160 160",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},c),n?s.createElement("title",{id:r},n):null,o||(o=s.createElement("path",{d:"M80 0 L30 80 L130 80 Z",strokeWidth:6,stroke:"gray",fill:"transparent"})))}var Ke,Qe,$e,et,tt=s.forwardRef(qe),nt=(n.p,["title","titleId"]);function rt(){return rt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rt.apply(this,arguments)}function ct(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function at(e,t){var n=e.title,r=e.titleId,c=ct(e,nt);return s.createElement("svg",rt({id:"svg",viewBox:"0 0 160 160",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},c),n?s.createElement("title",{id:r},n):null,Ke||(Ke=s.createElement("path",{d:"M80 0 L30 80 L130 80 Z",strokeWidth:6,stroke:"gray",fill:"transparent"})),Qe||(Qe=s.createElement("circle",{stroke:"gray",strokeWidth:6,fill:"transparent",cx:45,cy:115,r:20})),$e||($e=s.createElement("circle",{stroke:"gray",strokeWidth:6,fill:"transparent",cx:115,cy:115,r:20})),et||(et=s.createElement("line",{x1:30,y1:150,x2:130,y2:150,stroke:"gray",strokeWidth:6})))}var it,ot,st,lt,ut=s.forwardRef(at),bt=(n.p,["title","titleId"]);function dt(){return dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dt.apply(this,arguments)}function jt(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function ft(e,t){var n=e.title,r=e.titleId,c=jt(e,bt);return s.createElement("svg",dt({id:"svg",style:{width:64},viewBox:"0 0 160 160",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},c),n?s.createElement("title",{id:r},n):null,it||(it=s.createElement("path",{d:"M30 3 L30 80 L130 80 L130 3 Z",strokeWidth:6,stroke:"gray",fill:"transparent"})),ot||(ot=s.createElement("circle",{stroke:"gray",strokeWidth:6,fill:"transparent",cx:45,cy:115,r:20})),st||(st=s.createElement("circle",{stroke:"gray",strokeWidth:6,fill:"transparent",cx:115,cy:115,r:20})),lt||(lt=s.createElement("line",{x1:30,y1:150,x2:130,y2:150,stroke:"gray",strokeWidth:6})))}var Ot,vt,ht,xt,pt,gt=s.forwardRef(ft),mt=(n.p,["title","titleId"]);function yt(){return yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yt.apply(this,arguments)}function Ct(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function wt(e,t){var n=e.title,r=e.titleId,c=Ct(e,mt);return s.createElement("svg",yt({id:"svg",style:{width:64},viewBox:"0 0 160 160",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},c),n?s.createElement("title",{id:r},n):null,Ot||(Ot=s.createElement("line",{x1:0,y1:3,x2:160,y2:3,stroke:"gray",strokeWidth:6})),vt||(vt=s.createElement("line",{x1:20,y1:0,x2:0,y2:60,stroke:"gray",strokeWidth:6})),ht||(ht=s.createElement("line",{x1:60,y1:0,x2:40,y2:60,stroke:"gray",strokeWidth:6})),xt||(xt=s.createElement("line",{x1:100,y1:0,x2:80,y2:60,stroke:"gray",strokeWidth:6})),pt||(pt=s.createElement("line",{x1:140,y1:0,x2:120,y2:60,stroke:"gray",strokeWidth:6})))}var kt=s.forwardRef(wt),St=(n.p,["values"]),It={free:{type:"free",icon:Object(A.jsx)(Ge.a,{}),label:"\u5b8c\u5168\u30d5\u30ea\u30fc"},pin:{type:"pin",icon:Object(A.jsx)(Le.a,{sx:{width:24},viewBox:"0 0 160 160",children:Object(A.jsx)(tt,{})}),label:"\u5b8c\u5168\u30d4\u30f3"},pinX:{type:"pinX",icon:Object(A.jsx)(Le.a,{sx:{width:24},viewBox:"0 0 160 160",children:Object(A.jsx)(ut,{})}),label:"\u30d4\u30f3X\u30ed\u30fc\u30e9\u30fc"},pinZ:{type:"pinZ",icon:Object(A.jsx)(Le.a,{sx:{width:24,transform:"rotate(-90deg)"},viewBox:"0 0 160 160",children:Object(A.jsx)(ut,{})}),label:"\u30d4\u30f3Z\u30ed\u30fc\u30e9\u30fc"},fixX:{type:"fixX",icon:Object(A.jsx)(Le.a,{sx:{width:24},viewBox:"0 0 160 160",children:Object(A.jsx)(gt,{})}),label:"\u56fa\u5b9aX\u30ed\u30fc\u30e9\u30fc"},fix:{type:"fix",icon:Object(A.jsx)(Le.a,{sx:{width:24},viewBox:"0 0 160 160",children:Object(A.jsx)(kt,{})}),label:"\u5b8c\u5168\u56fa\u5b9a"}},Et={sx:{justifyContent:"flex-start",alignItems:"center"}},zt=function(e){var t=e.node,n=e.onChange,r=e.onClose,c=Object(s.useState)(),a=Object(O.a)(c,2),i=a[0],o=a[1],l=Object(s.useCallback)((function(e){e.preventDefault();var c=Object(S.a)(Object(S.a)({},t),{},{pin:i});n(c),r()}),[t,n,r,i]),u=Object(s.useCallback)((function(e,t){var n;null!==t&&("string"===typeof(n=t)&&z.some((function(e){return e===n})))&&o(t)}),[]);return Object(s.useEffect)((function(){var e;o(null!==(e=t.pin)&&void 0!==e?e:"free")}),[t.pin]),Object(A.jsx)(Re.a,{children:Object(A.jsxs)(Te.a,{direction:"column",spacing:1,sx:{p:1,width:240},component:"form",autoComplete:"off",noValidate:!0,onSubmit:l,children:[Object(A.jsx)(Ye.a,{orientation:"vertical",value:i,size:"small",exclusive:!0,fullWidth:!0,onChange:u,children:Object.entries(It).map((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1],c=r.icon,a=r.label;return Object(A.jsxs)(Ue.a,Object(S.a)(Object(S.a)({value:n},Et),{},{children:[c,Object(A.jsx)(H.a,{variant:"caption",sx:{ml:1},children:a})]}),n)}))}),Object(A.jsxs)(Te.a,{direction:"row",justifyContent:"flex-end",spacing:1,children:[Object(A.jsx)(Be.a,{size:"small",onClick:r,children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),Object(A.jsx)(Be.a,{type:"submit",size:"small",variant:"contained",children:"OK"})]})]})})},Nt=function(e){var t=e.values,n=Object(De.a)(e,St),r=Object(s.useMemo)((function(){return N(t)?t:{id:"",x:0,y:0}}),[t]);return Object(A.jsx)(zt,Object(S.a)(Object(S.a)({},n),{},{node:r}))},Mt=n(3),Pt=n(191),Dt=n(177),Rt=["values"],Tt=function(e){if(0===e.length)return[NaN,!1,"\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"];var t=parseFloat(e);return isNaN(t)?[NaN,!1,"\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"]:0>=t&&t>Number.MAX_SAFE_INTEGER?[t,!1,"0 \u4ee5\u4e0a\u306e\u6570\u5024\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"]:[C(t,3),!0,""]},_t=function(e){if(e.length>0){var t=parseInt(e,10);return isNaN(t)||e.indexOf(".")>=0?[NaN,!1,"\u6574\u6570\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"]:-180>t||180<t?[t,!1,"-180 \u301c 180 \u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"]:(-180===t&&(t=180),[t,!0,""])}return[90,!0,""]},Wt=function(e){var t,n,r,c,a,i,o,l=e.trapezoid,u=e.onChange,b=e.onClose,d=Object(s.useState)({}),j=Object(O.a)(d,2),f=j[0],v=j[1],h=Object(s.useState)({}),x=Object(O.a)(h,2),p=x[0],g=x[1],m=Object(s.useCallback)((function(e){if((e.preventDefault(),e.currentTarget.checkValidity())&&!Object.values(p).some((function(e){return e.length>0}))){var t=function(e){var t,n,r,c,a={forceI:0,forceJ:0,angle:90,isGlobal:!1},i=Tt(null!==(t=e.forceI)&&void 0!==t?t:""),o=Object(O.a)(i,2),s=o[0],l=o[1],u=Tt(null!==(n=e.forceJ)&&void 0!==n?n:""),b=Object(O.a)(u,2),d=b[0],j=b[1],f=_t(null!==(r=e.angle)&&void 0!==r?r:""),v=Object(O.a)(f,2),h=v[0],x=v[1],p=l&&j&&x;return a.forceI=s,a.forceJ=d,a.angle=h,a.isGlobal=null!==(c=e.isGlobal)&&void 0!==c&&c,[p,a]}(f),n=Object(O.a)(t,2),r=n[0],c=n[1];console.log(r,c),r&&u(Object(S.a)(Object(S.a)({},l),c)),b()}}),[p,u,b,l,f]),y=Object(s.useCallback)((function(e){var t=e.target,n=t.name,r=t.value,c="";switch(n){case"forceI":case"forceJ":var a=Tt(r),i=Object(O.a)(a,3),o=i[1],s=i[2];o||(c=s);break;case"angle":var l=_t(r),u=Object(O.a)(l,3),b=u[1],d=u[2];b||(c=d)}g((function(e){return Object(S.a)(Object(S.a)({},e),{},Object(Mt.a)({},n,c))})),v((function(e){return Object(S.a)(Object(S.a)({},e),{},Object(Mt.a)({},n,r))}))}),[]),C=Object(s.useCallback)((function(e){var t=e.target.checked;v((function(e){return Object(S.a)(Object(S.a)({},e),{},{isGlobal:t})}))}),[]);return Object(s.useEffect)((function(){v(function(e){var t,n={};return n.forceI="".concat(e.forceI),n.forceJ="".concat(e.forceJ),n.angle="".concat(null!==(t=e.angle)&&void 0!==t?t:""),n.isGlobal=e.isGlobal,n}(l)),g({})}),[l]),Object(A.jsx)(Re.a,{children:Object(A.jsxs)(Te.a,{direction:"column",spacing:1,sx:{p:1,width:240},component:"form",autoComplete:"off",noValidate:!0,onSubmit:m,children:[Object(A.jsx)(_e.a,{variant:"outlined",margin:"dense",size:"small",label:"I\u7aef\u5074\u306e\u8377\u91cd",name:"forceI",value:null!==(t=f.forceI)&&void 0!==t?t:"",required:!0,fullWidth:!0,onChange:y,InputProps:{endAdornment:Object(A.jsx)(We.a,{position:"end",children:"kN/m"})},error:Boolean(p.forceI),helperText:null!==(n=p.forceI)&&void 0!==n?n:""}),Object(A.jsx)(_e.a,{variant:"outlined",margin:"dense",size:"small",label:"J\u7aef\u5074\u306e\u8377\u91cd",name:"forceJ",value:null!==(r=f.forceJ)&&void 0!==r?r:"",required:!0,fullWidth:!0,onChange:y,InputProps:{endAdornment:Object(A.jsx)(We.a,{position:"end",children:"kN/m"})},error:Boolean(p.forceJ),helperText:null!==(c=p.forceJ)&&void 0!==c?c:""}),Object(A.jsx)(_e.a,{variant:"outlined",margin:"dense",size:"small",label:"\u89d2\u5ea6",name:"angle",value:null!==(a=f.angle)&&void 0!==a?a:"",fullWidth:!0,onChange:y,InputProps:{endAdornment:Object(A.jsx)(We.a,{position:"end",children:"\xb0"})},error:Boolean(p.angle),helperText:null!==(i=p.angle)&&void 0!==i?i:""}),Object(A.jsx)(Pt.a,{label:"\u5168\u4f53\u5ea7\u6a19\u7cfb",control:Object(A.jsx)(Dt.a,{name:"isGlobal",size:"small",checked:null!==(o=f.isGlobal)&&void 0!==o&&o,onChange:C})}),Object(A.jsxs)(Te.a,{direction:"row",justifyContent:"flex-end",spacing:1,children:[Object(A.jsx)(Be.a,{size:"small",onClick:b,children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),Object(A.jsx)(Be.a,{type:"submit",size:"small",variant:"contained",children:"OK"})]})]})})},Bt=function(e){var t=e.values,n=Object(De.a)(e,Rt),r=Object(s.useMemo)((function(){return P(t)?t:{id:"",name:"",beam:"",forceI:0,distanceI:0,forceJ:0,distanceJ:0}}),[t]);return Object(A.jsx)(Wt,Object(S.a)(Object(S.a)({},n),{},{trapezoid:r}))},At=function(){var e=Object(s.useContext)(Ne),t=e.popupType,n=e.popupPosition,r=e.popupParams,c=e.close,a=Object(s.useContext)(ce),i=a.onChangeNode,o=a.onChangeForce,l=a.onChangeTrapezoid;return"undefined"===typeof t?null:Object(A.jsxs)(U.a,{sx:Object(S.a)({position:"absolute",zIndex:5e3},n),children:["forces"===t&&Object(A.jsx)(Fe,{values:null!==r&&void 0!==r?r:{},onClose:c,onChange:o}),"trapezoids"===t&&Object(A.jsx)(Bt,{values:null!==r&&void 0!==r?r:{},onClose:c,onChange:l}),"nodes"===t&&Object(A.jsx)(Nt,{values:null!==r&&void 0!==r?r:{},onClose:c,onChange:i})]})},Jt=function(e,t){var n=Object(s.useContext)(ce),r=n.tool,c=n.size,a=n.getStructure,i=n.clearSelection,o=Object(s.useContext)(Ne).close,l=Object(s.useContext)(se),u=l.onPointerDown,b=l.onPointerMove,d=l.onPointerUp,j=ne(ce,Ne,se),f=Object(s.useRef)(null);Object(s.useImperativeHandle)(t,(function(){return{toDataURL:function(){if(f.current)return f.current.toDataURL()},getStructure:a}}),[a]);var O=Object(s.useCallback)((function(e){o(),"select"===r&&i()}),[i,o,r]);return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(te.h,{ref:f,width:c.width,height:c.height,onClick:O,onTap:O,onPointerDown:u,onPointerMove:b,onPointerUp:d,children:Object(A.jsxs)(j,{children:[Object(A.jsx)(de,{}),Object(A.jsx)(ze,{}),Object(A.jsx)(Pe,{}),Object(A.jsx)(ue,{})]})}),Object(A.jsx)(At,{})]})},Ft=Object(s.forwardRef)(Jt),Xt=function(e,t){var n=e.tool,r=void 0===n?"select":n,c=e.structure,a=e.readonly,i=void 0!==a&&a,o=Object(s.useState)({width:0,height:0}),l=Object(O.a)(o,2),u=l[0],b=l[1],d=Object(s.useRef)(null),j=Object(s.useRef)(null);return Object(s.useImperativeHandle)(t,(function(){return{toDataURL:function(){if(j.current)return j.current.toDataURL()},getStructure:function(){return j.current?j.current.getStructure():D}}}),[]),Object(s.useEffect)((function(){var e=new ResizeObserver((function(e){var t=e[0].contentRect,n=t.width,r=t.height;b({width:n,height:r})}));return d.current&&e.observe(d.current),function(){e.disconnect()}}),[]),Object(A.jsx)(U.a,{ref:d,sx:{width:"auto",height:"100%",backgroundColor:"#ffffff",overscrollBehavior:"contain"},children:Object(A.jsx)(ae,{tool:r,size:u,structure:c,readonly:i,children:Object(A.jsx)(le,{children:Object(A.jsx)(Me,{children:Object(A.jsx)(Ft,{ref:j})})})})})},Gt=Object(s.forwardRef)(Xt),Lt=["eraser"],Yt=function(e){var t=e.drawings,n=e.settings,r=e.points;return Object(A.jsxs)(te.e,{children:[t.map((function(e,t){var n=e.eraser,r=void 0!==n&&n,c=Object(De.a)(e,Lt);return Object(A.jsx)(te.f,Object(S.a)(Object(S.a)({},c),{},{globalCompositeOperation:r?"destination-out":"source-over"}),"note-drawing-".concat(t))})),r&&Object(A.jsx)(te.f,Object(S.a)(Object(S.a)({},n),{},{points:r,globalCompositeOperation:n.eraser?"destination-out":"source-over"}))]})},Ut=n(91),Zt=n.n(Ut),Vt=n(92),Ht=n.n(Vt),qt=n(93),Kt=n.n(qt),Qt=n(8),$t=n(193),en=n(94),tn=n(178),nn=n(96),rn=Object(Qt.a)("div")({display:"flex",alignItems:"center",width:"100%",padding:"0 8"}),cn=Object(Qt.a)("div")({flex:1}),an=function(e){var t=e.visible,n=void 0!==t&&t,r=e.mode,c=e.y,a=e.x,i=e.width,o=e.onEdit,l=e.onCopy,u=e.onDelete,b=e.onCancel,d=Object(s.useState)(null),j=Object(O.a)(d,2),f=j[0],v=j[1],h=Object(s.useCallback)((function(e){v(e.currentTarget)}),[]),x=Object(s.useCallback)((function(){v(null)}),[]);return n?Object(A.jsxs)(nn.a,{divProps:{style:{top:"".concat(c-42,"px"),left:"".concat(a,"px"),width:"".concat(i,"px")}},children:[Object(A.jsxs)(rn,{children:["canvas"===r&&Object(A.jsx)($t.a,{size:"small",onClick:b,children:Object(A.jsx)(Zt.a,{})}),"note"===r&&Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)($t.a,{size:"small",onClick:o,children:Object(A.jsx)(Ht.a,{})}),Object(A.jsx)(cn,{}),Object(A.jsx)($t.a,{size:"small",onClick:h,children:Object(A.jsx)(Kt.a,{})})]})]}),Object(A.jsxs)(en.a,{anchorEl:f,open:Boolean(f),onClose:x,children:[Object(A.jsx)(tn.a,{onClick:l,children:"\u30b3\u30d4\u30fc"}),Object(A.jsx)(tn.a,{onClick:u,children:"\u524a\u9664"})]})]}):null},on=["size","draggable","index","onChange","selected","onSelect","data","image"],sn=function(e){var t=e.size,n=e.draggable,r=void 0!==n&&n,c=e.index,a=e.onChange,i=e.selected,o=void 0!==i&&i,l=e.onSelect,u=(e.data,e.image),b=Object(De.a)(e,on),d=Object(s.useRef)(null),j=Object(s.useRef)(null),f=Object(s.useState)(!1),v=Object(O.a)(f,2),h=v[0],x=v[1],p=ge()(null!==u&&void 0!==u?u:""),g=Object(O.a)(p,1)[0],m=Object(s.useContext)(L).mode,C=Object(s.useContext)(J),w=C.mode,k=C.editCanvas,I=C.closeCanvas,E=Object(s.useMemo)((function(){return T[t]}),[t]),z=Object(s.useMemo)((function(){return o&&!h&&"select"===m}),[h,m,o]),N=Object(s.useMemo)((function(){return r&&o}),[r,o]);Object(s.useEffect)((function(){var e;o&&j.current&&d.current&&(j.current.nodes([d.current]),null===(e=j.current.getLayer())||void 0===e||e.batchDraw())}),[o]);var M=Object(s.useCallback)((function(e){a((function(t){var n=y(t),r=n.structures[c];return n.structures[c]=Object(S.a)(Object(S.a)({},r),e),n}))}),[c,a]),P=Object(s.useCallback)((function(){x(!0)}),[]),D=Object(s.useCallback)((function(e){if(e.cancelBubble=!0,d.current){var t=e.target.attrs,n=t.x,r=t.y;if("number"===typeof n&&"number"===typeof r){var c=d.current.getSize(),a=c.width,i=c.height,o=n,s=r;o<0?o=0:o>E.width-a&&(o=E.width-a),s<0?s=0:s>E.height-i&&(s=E.height-i),n===o&&r===s||d.current.setPosition({x:o,y:s})}}}),[E.height,E.width]),R=Object(s.useCallback)((function(e){if(d.current){var t=d.current.getPosition(),n=t.x,r=t.y,c=d.current.getSize(),a={x:n,y:r,width:c.width,height:c.height};x(!1),M(a)}}),[M]),W=Object(s.useCallback)((function(e,t){return t.width<_.width||t.height<_.height?e:t}),[]),B=Object(s.useCallback)((function(){if(d.current){var e=d.current,t=e.scale(),n=t.x,r=t.y;e.scale({x:1,y:1});var c={x:e.x(),y:e.y(),width:Math.max(_.width,e.width()*n),height:Math.max(_.height,e.height()*r)};M(c)}}),[M]),F=Object(s.useCallback)((function(e){var t=e.currentTarget.getBoundingClientRect(),n=t.top,r={x:t.left,y:n+42,width:b.width,height:b.height};k(r)}),[k,b.height,b.width]);return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(te.g,Object(S.a)(Object(S.a)({},b),{},{fill:"white"})),g&&Object(A.jsx)(te.d,Object(S.a)(Object(S.a)({},b),{},{image:g})),Object(A.jsx)(te.g,Object(S.a)(Object(S.a)({ref:d,stroke:"black",strokeWidth:2,draggable:r},b),{},{onClick:l,onTap:l,onDragStart:P,onDragMove:D,onDragEnd:R,onTransformEnd:B})),Object(A.jsx)(an,Object(S.a)(Object(S.a)({visible:z,mode:w},b),{},{onEdit:F,onCancel:I})),Object(A.jsx)(te.j,{ref:j,visible:N,rotateEnabled:!1,boundBoxFunc:W})]})},ln=function(e){var t=e.size,n=e.structures,r=e.draggable,c=void 0!==r&&r,a=e.onChange,i=Object(s.useContext)(J),o=i.selectedCanvasIndex,l=i.onSelectCanvas,u=Object(s.useMemo)((function(){return T[t]}),[t]),b=Object(s.useCallback)((function(e){"background"===e.target.attrs.type&&l(void 0)}),[l]);return Object(A.jsxs)(te.e,{children:[Object(A.jsx)(te.g,Object(S.a)(Object(S.a)({x:0,y:0},u),{},{attrs:{type:"background"},onClick:b,onTap:b})),n.map((function(e,n){return Object(A.jsx)(sn,Object(S.a)({size:t,draggable:c,index:n,onChange:a,selected:n===o,onSelect:function(){return l(n)}},e),"handle-".concat(n))}))]})},un={id:"",points:[],stroke:"#c9e1ff",strokeWidth:1,dash:[5,3],listening:!1},bn=function(e){var t=e.size,n=Object(s.useMemo)((function(){return T[t]}),[t]),r=Object(s.useMemo)((function(){for(var e=[],t=1,r=0;r<=n.height;r+=50)e.push(Object(S.a)(Object(S.a)({},un),{},{id:"Horizontal_".concat(t),points:[0,r,n.width,r]})),t++;return e}),[n]),c=Object(s.useMemo)((function(){for(var e=[],t=1,r=0;r<=n.width;r+=50)e.push(Object(S.a)(Object(S.a)({},un),{},{id:"Vertical_".concat(t),points:[r,0,r,n.height]})),t++;return e}),[n]);return Object(A.jsxs)(te.e,{children:[r.map((function(e){return Object(A.jsx)(te.f,Object(S.a)({},e),e.id)})),c.map((function(e){return Object(A.jsx)(te.f,Object(S.a)({},e),e.id)}))]})},dn=function(e){var t=e.viewBox,n=e.size,r=e.drawings,c=e.structures,a=e.onChange,i=Object(s.useRef)(null),o=Object(s.useContext)(L),l=o.mode,u=o.settings,b=Object(s.useContext)(J).mode,d=ne(J,X,L),j=Object(s.useRef)(),f=Object(s.useState)([]),v=Object(O.a)(f,2),h=v[0],x=v[1],p=Object(s.useMemo)((function(){return T[n]}),[n]),g=Object(s.useMemo)((function(){return"note"===b&&"select"===l}),[b,l]),m=Object(s.useCallback)((function(e){var n=e.target.attrs,r=n.x,c=n.y;if(i.current&&"number"===typeof r&&"number"===typeof c){var a=r,o=c,s=!1;a>0?(a=0,s=!0):Math.abs(a)+t.width>p.width&&(a=t.width-p.width,s=!0),o>0?(o=0,s=!0):Math.abs(o)+t.height>p.height&&(o=t.height-p.height,s=!0),s&&i.current.setPosition({x:a,y:o})}}),[p.height,p.width,t.height,t.width]),C=Object(s.useCallback)((function(e){var t;if("edit"===l){var n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();if(i.current&&n){j.current=!0;var r=i.current.getPosition(),c=r.x,a=r.y;x([n.x+Math.abs(c),n.y+Math.abs(a)])}}}),[l]),w=Object(s.useCallback)((function(e){var t;if("edit"===l&&j.current){var n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();if(i.current&&n){var r=i.current.getPosition(),c=r.x,a=r.y;x((function(e){return[].concat(Object(re.a)(e),[n.x+Math.abs(c),n.y+Math.abs(a)])}))}}}),[l]),k=Object(s.useCallback)((function(e){"edit"===l&&j.current&&(j.current=!1,a((function(e){var t=y(e);return t.drawings.push(Object(S.a)(Object(S.a)({},u),{},{points:h})),t})),x([]))}),[l,a,h,u]);return Object(A.jsx)(te.h,{ref:i,width:t.width,height:t.height,draggable:g,onDragMove:m,onPointerDown:C,onPointerMove:w,onPointerUp:k,children:Object(A.jsxs)(d,{children:[Object(A.jsx)(bn,{size:n}),Object(A.jsx)(ln,{size:n,structures:c,draggable:g,onChange:a}),Object(A.jsx)(Yt,{drawings:r,settings:u,points:h})]})})},jn=function(){var e=Object(s.useRef)(null),t=Object(s.useState)({width:0,height:0}),n=Object(O.a)(t,2),r=n[0],c=n[1],a=Object(s.useContext)(J),i=a.page,o=a.onChange;return Object(s.useEffect)((function(){var t=new ResizeObserver((function(e){var t=e[0].contentRect,n=t.width,r=t.height;c({width:n,height:r})}));return e.current&&t.observe(e.current),function(){t.disconnect()}}),[]),Object(A.jsx)(U.a,{ref:e,sx:{width:"auto",height:"100%",backgroundColor:"#ffffff",overscrollBehavior:"contain",overflow:"hidden"},children:Object(A.jsx)(dn,Object(S.a)(Object(S.a)({viewBox:r},i),{},{onChange:o}))})},fn=function(){var e=Object(s.useContext)(J),t=e.page,n=e.selectedCanvasIndex,r=e.canvasProps,c=e.canvasRef,a=Object(s.useContext)(X).tool,i=Object(s.useMemo)((function(){if("number"===typeof n)return t.structures[n].data}),[t.structures,n]);return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(U.a,{sx:{boxSizing:"border-box",ml:1,mb:1,flex:1,border:function(e){return"1px solid ".concat(e.palette.divider)},borderRadius:1,overflow:"hidden"},children:Object(A.jsx)(jn,{})}),r&&Object(A.jsx)(U.a,{sx:{position:"absolute",top:r.y,left:r.x,width:r.width,height:r.height,backgroundColor:"red"},children:Object(A.jsx)(Gt,{ref:c,tool:a,structure:null!==i&&void 0!==i?i:D})})]})},On=n(168),vn=n(169),hn=n(170),xn=n(171),pn=n(172),gn={select:{tool:"select",icon:Object(A.jsx)(On.a,{}),label:"\u9078\u629e"},pen:{tool:"pen",icon:Object(A.jsx)(vn.a,{}),label:"\u6881\u8981\u7d20\u306e\u63cf\u753b"},force:{tool:"force",icon:Object(A.jsx)(hn.a,{}),label:"\u96c6\u4e2d\u8377\u91cd\u306e\u8ffd\u52a0"},trapezoid:{tool:"trapezoid",icon:Object(A.jsx)(xn.a,{}),label:"\u5206\u5e03\u8377\u91cd\u306e\u8ffd\u52a0"},delete:{tool:"delete",icon:Object(A.jsx)(pn.a,{}),label:"\u8981\u7d20\u306e\u524a\u9664"}},mn=function(e){var t=e.tool,n=e.onChange,r=Object(s.useCallback)((function(e,t){var r;null!==t&&("string"===typeof(r=t)&&ie.some((function(e){return e===r})))&&n(t)}),[n]);return Object(A.jsxs)(Te.a,{sx:{width:160},alignItems:"flex-start",children:[Object(A.jsx)(H.a,{variant:"caption",children:"Toolbox"}),Object(A.jsx)(Ye.a,{orientation:"vertical",value:t,exclusive:!0,fullWidth:!0,onChange:r,children:Object.entries(gn).map((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1],c=r.icon,a=r.label;return Object(A.jsxs)(Ue.a,{value:n,sx:{justifyContent:"flex-start",alignItems:"center"},children:[c,Object(A.jsx)(H.a,{variant:"caption",sx:{ml:1},children:a})]},n)}))})]})},yn=function(){var e=Object(s.useContext)(X),t=e.tool,n=e.setTool;return Object(A.jsx)(mn,{tool:t,onChange:n})},Cn=n(173),wn=n(179),kn=["pen","eraser"],Sn={select:{mode:"select",icon:Object(A.jsx)(On.a,{}),label:"\u9078\u629e"},edit:{mode:"edit",icon:Object(A.jsx)(vn.a,{}),label:"\u63cf\u753b"}},In={pen:{mode:"pen",icon:Object(A.jsx)(vn.a,{}),label:"\u30da\u30f3\u30c4\u30fc\u30eb"},eraser:{mode:"eraser",icon:Object(A.jsx)(Cn.a,{}),label:"\u6d88\u3057\u30b4\u30e0"}},En=function(e){var t=e.mode,n=e.settings,r=e.onChangeMode,c=e.onChangeDrawSettings,a=Object(s.useCallback)((function(e,t){var n;null!==t&&("string"===typeof(n=t)&&R.some((function(e){return e===n})))&&r(t)}),[r]),i=Object(s.useCallback)((function(e,t){var n;null!==t&&("string"===typeof(n=t)&&kn.some((function(e){return e===n})))&&c((function(e){return Object(S.a)(Object(S.a)({},e),{},{eraser:"eraser"===t})}))}),[c]),o=Object(s.useCallback)((function(e,t){"number"===typeof t&&c((function(e){return Object(S.a)(Object(S.a)({},e),{},{strokeWidth:t})}))}),[c]),l=Object(s.useCallback)((function(e){if(e.target.checkValidity()){var t=e.target.value;c((function(e){return Object(S.a)(Object(S.a)({},e),{},{stroke:t})}))}}),[c]);return Object(A.jsxs)(Te.a,{sx:{width:160},alignItems:"flex-start",children:[Object(A.jsx)(H.a,{variant:"caption",children:"Toolbox"}),Object(A.jsx)(Ye.a,{orientation:"vertical",value:t,exclusive:!0,fullWidth:!0,onChange:a,children:Object.entries(Sn).map((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1],c=r.icon,a=r.label;return Object(A.jsxs)(Ue.a,{value:n,sx:{justifyContent:"flex-start",alignItems:"center"},children:[c,Object(A.jsx)(H.a,{variant:"caption",sx:{ml:1},children:a})]},n)}))}),Object(A.jsx)(H.a,{variant:"caption",sx:{mt:1},children:"\u63cf\u753b\u30c4\u30fc\u30eb"}),Object(A.jsx)(Ye.a,{orientation:"vertical",value:n.eraser?"eraser":"pen",exclusive:!0,fullWidth:!0,disabled:"select"===t,onChange:i,children:Object.entries(In).map((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1],c=r.icon,a=r.label;return Object(A.jsxs)(Ue.a,{value:n,sx:{justifyContent:"flex-start",alignItems:"center"},children:[c,Object(A.jsx)(H.a,{variant:"caption",sx:{ml:1},children:a})]},n)}))}),Object(A.jsx)(H.a,{variant:"caption",sx:{mt:1},children:"\u592a\u3055"}),Object(A.jsx)(wn.a,{sx:{ml:1,mb:2,boxSizing:"border-box",width:140},value:n.strokeWidth,min:4,max:20,step:4,marks:!0,valueLabelDisplay:"auto",disabled:"select"===t,onChange:o}),Object(A.jsx)(_e.a,{type:"color",label:"\u30da\u30f3\u306e\u8272",value:n.stroke,disabled:"select"===t||n.eraser,fullWidth:!0,margin:"dense",size:"small",onChange:l})]})},zn=function(){var e=Object(s.useContext)(L);return Object(A.jsx)(En,Object(S.a)({},e))},Nn=function(){return"canvas"===Object(s.useContext)(J).mode?Object(A.jsx)(yn,{}):Object(A.jsx)(zn,{})},Mn=function(){var e=Object(s.useState)({width:0,height:0}),t=Object(O.a)(e,2),n=t[0],r=t[1],c=Object(s.useCallback)((function(){var e=window,t=e.innerHeight,n=e.innerWidth;r({height:t,width:n})}),[]);return Object(s.useEffect)((function(){return c(),window.addEventListener("resize",c),function(){window.removeEventListener("resize",c)}}),[c]),Object(A.jsxs)(U.a,{sx:Object(S.a)(Object(S.a)({},n),{},{overflow:"hidden"}),children:[Object(A.jsx)(ee,{}),Object(A.jsxs)(U.a,{sx:{boxSizing:"border-box",width:"auto",height:"calc(100% - 48px)",display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",pt:1,px:1},children:[Object(A.jsx)(Nn,{}),Object(A.jsx)(fn,{})]})]})},Pn=Object(d.a)(),Dn=function(){return Object(A.jsx)(j.a,{theme:Pn,children:Object(A.jsx)(F,{children:Object(A.jsx)(G,{children:Object(A.jsxs)(Y,{children:[Object(A.jsx)(f.a,{}),Object(A.jsx)(Mn,{})]})})})})},Rn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,194)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};b.a.render(Object(A.jsx)(l.a.StrictMode,{children:Object(A.jsx)(Dn,{})}),document.getElementById("root")),Rn()}},[[124,1,2]]]);
//# sourceMappingURL=main.10c85652.chunk.js.map