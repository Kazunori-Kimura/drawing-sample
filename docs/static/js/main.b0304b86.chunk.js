(this["webpackJsonpdrawing-sample"]=this["webpackJsonpdrawing-sample"]||[]).push([[0],{97:function(e,t,n){"use strict";n.r(t);var i,c,r,a,o=n(0),s=n.n(o),b=n(30),u=n.n(b),j=n(73),l=n(148),d=n(141),h=n(12),O=n(2),f=Object(o.createContext)(void 0),x=function(e){var t=e.children,n=Object(o.useState)("select"),i=Object(h.a)(n,2),c=i[0],r=i[1];return Object(O.jsx)(f.Provider,{value:{tool:c,setTool:r},children:t})},g=n(17),v={unit:{force:"kN",length:"m"},nodes:[],beams:[],forces:[],trapezoids:[]},p=["select","edit"],w={A3:{width:0,height:0},A4:{width:2970,height:2100},B4:{width:0,height:0},B5:{width:0,height:0}},m={stroke:"#000000",strokeWidth:4,eraser:!1,lineJoin:"round",lineCap:"round"},C={size:"A4",drawings:[],structures:[Object(g.a)({data:v,x:100,y:100},{width:160,height:90})]},k=Object(o.createContext)(void 0),S=function(e){var t=e.children,n=Object(o.useState)("select"),i=Object(h.a)(n,2),c=i[0],r=i[1],a=Object(o.useState)(m),s=Object(h.a)(a,2),b=s[0],u=s[1];return Object(O.jsx)(k.Provider,{value:{mode:c,settings:b,onChangeMode:r,onChangeDrawSettings:u},children:t})},y=n(153),z=n(150),P=n(152),M=n(149),W=null!==(i=null===(c="9dcf50a04c57cd016aec39a9cd8dc87a3980232d\n")?void 0:c.substring(0,7))&&void 0!==i?i:"",D=null!==(r="2022/01/07 09:54:48")?r:"",B=null!==(a="0.1.0")?a:"",I=function(){return Object(O.jsx)(M.a,{variant:"caption",sx:{ml:2},children:"ver ".concat(B," (").concat(W,": ").concat(D,")")})},R=function(){return Object(O.jsx)(z.a,{position:"static",children:Object(O.jsxs)(P.a,{variant:"dense",children:[Object(O.jsx)(M.a,{component:"h1",variant:"h6",color:"inherit",children:"Drawing Sample"}),Object(O.jsx)(I,{})]})})},E=n(18),J=n(26),L=n(44),F=n.n(L),T=(new F.a(1,0),new F.a(0,1),n(145),n(74)),A=["eraser"],N=function(e){var t=e.drawings,n=e.settings,i=e.points;return Object(O.jsxs)(J.a,{children:[t.map((function(e,t){var n=e.eraser,i=void 0!==n&&n,c=Object(T.a)(e,A);return Object(O.jsx)(J.b,Object(g.a)(Object(g.a)({},c),{},{globalCompositeOperation:i?"destination-out":"source-over"}),"note-drawing-".concat(t))})),i&&Object(O.jsx)(J.b,Object(g.a)(Object(g.a)({},n),{},{points:i,globalCompositeOperation:n.eraser?"destination-out":"source-over"}))]})},H={id:"",points:[],stroke:"#c9e1ff",strokeWidth:1,dash:[5,3],listening:!1},V=function(e){var t=e.size,n=Object(o.useMemo)((function(){return w[t]}),[t]),i=Object(o.useMemo)((function(){for(var e=[],t=1,i=0;i<=n.height;i+=50)e.push(Object(g.a)(Object(g.a)({},H),{},{id:"Horizontal_".concat(t),points:[0,i,n.width,i]})),t++;return e}),[n]),c=Object(o.useMemo)((function(){for(var e=[],t=1,i=0;i<=n.width;i+=50)e.push(Object(g.a)(Object(g.a)({},H),{},{id:"Vertical_".concat(t),points:[i,0,i,n.height]})),t++;return e}),[n]);return Object(O.jsxs)(J.a,{children:[i.map((function(e){return Object(O.jsx)(J.b,Object(g.a)({},e),e.id)})),c.map((function(e){return Object(O.jsx)(J.b,Object(g.a)({},e),e.id)}))]})},_=function(e){var t=e.viewBox,n=e.size,i=e.drawings,c=e.onChange,r=Object(o.useRef)(null),a=Object(o.useContext)(k),s=a.mode,b=a.settings,u=Object(o.useRef)(),j=Object(o.useState)([]),l=Object(h.a)(j,2),d=l[0],f=l[1],x=Object(o.useMemo)((function(){return w[n]}),[n]),v=Object(o.useCallback)((function(e){var n=e.target.attrs,i=n.x,c=n.y;if(r.current&&"number"===typeof i&&"number"===typeof c){var a=i,o=c,s=!1;a>0?(a=0,s=!0):Math.abs(a)+t.width>x.width&&(a=t.width-x.width,s=!0),o>0?(o=0,s=!0):Math.abs(o)+t.height>x.height&&(o=t.height-x.height,s=!0),s&&r.current.setPosition({x:a,y:o})}}),[x.height,x.width,t.height,t.width]),p=Object(o.useCallback)((function(e){var t;if("edit"===s){var n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();n&&(u.current=!0,f([n.x,n.y]))}}),[s]),m=Object(o.useCallback)((function(e){var t;if("edit"===s&&u.current){var n=null===(t=e.target.getStage())||void 0===t?void 0:t.getPointerPosition();n&&f((function(e){return[].concat(Object(E.a)(e),[n.x,n.y])}))}}),[s]),C=Object(o.useCallback)((function(e){"edit"===s&&u.current&&(u.current=!1,c((function(e){var t=function(e){return JSON.parse(JSON.stringify(e))}(e);return t.drawings.push(Object(g.a)(Object(g.a)({},b),{},{points:d})),t})),f([]))}),[s,c,d,b]);return Object(O.jsxs)(J.c,{ref:r,width:t.width,height:t.height,draggable:"select"===s,onDragMove:v,onPointerDown:p,onPointerMove:m,onPointerUp:C,children:[Object(O.jsx)(V,{size:n}),Object(O.jsx)(N,{drawings:i,settings:b,points:d})]})},U=function(){var e=Object(o.useRef)(null),t=Object(o.useState)({width:0,height:0}),n=Object(h.a)(t,2),i=n[0],c=n[1],r=Object(o.useState)(C),a=Object(h.a)(r,2),s=a[0],b=a[1];return Object(o.useEffect)((function(){var t=new ResizeObserver((function(e){var t=e[0].contentRect,n=t.width,i=t.height;c({width:n,height:i})}));return e.current&&t.observe(e.current),function(){t.disconnect()}}),[]),Object(O.jsx)(y.a,{ref:e,sx:{width:"auto",height:"100%",backgroundColor:"#ffffff",overscrollBehavior:"contain",overflow:"hidden"},children:Object(O.jsx)(_,Object(g.a)(Object(g.a)({viewBox:i},s),{},{onChange:b}))})},q=function(){return Object(O.jsx)(y.a,{sx:{boxSizing:"border-box",ml:1,mb:1,flex:1,border:function(e){return"1px solid ".concat(e.palette.divider)},borderRadius:1,overflow:"hidden"},children:Object(O.jsx)(U,{})})},G=n(134),K=n(135),Q=n(136),X=n(137),Y=n(147),Z=n(143),$=n(144),ee=n(142),te=["pen","eraser"],ne={select:{mode:"select",icon:Object(O.jsx)(G.a,{}),label:"\u9078\u629e"},edit:{mode:"edit",icon:Object(O.jsx)(K.a,{}),label:"\u63cf\u753b"}},ie={pen:{mode:"pen",icon:Object(O.jsx)(K.a,{}),label:"\u30da\u30f3\u30c4\u30fc\u30eb"},eraser:{mode:"eraser",icon:Object(O.jsx)(Q.a,{}),label:"\u6d88\u3057\u30b4\u30e0"}},ce=function(e){var t=e.mode,n=e.settings,i=e.onChangeMode,c=e.onChangeDrawSettings,r=Object(o.useCallback)((function(e,t){var n;null!==t&&("string"===typeof(n=t)&&p.some((function(e){return e===n})))&&i(t)}),[i]),a=Object(o.useCallback)((function(e,t){var n;null!==t&&("string"===typeof(n=t)&&te.some((function(e){return e===n})))&&c((function(e){return Object(g.a)(Object(g.a)({},e),{},{eraser:"eraser"===t})}))}),[c]),s=Object(o.useCallback)((function(e,t){"number"===typeof t&&c((function(e){return Object(g.a)(Object(g.a)({},e),{},{strokeWidth:t})}))}),[c]),b=Object(o.useCallback)((function(e){if(e.target.checkValidity()){var t=e.target.value;c((function(e){return Object(g.a)(Object(g.a)({},e),{},{stroke:t})}))}}),[c]);return Object(O.jsxs)(X.a,{sx:{width:160},alignItems:"flex-start",children:[Object(O.jsx)(M.a,{variant:"caption",children:"Toolbox"}),Object(O.jsx)(Y.a,{orientation:"vertical",value:t,exclusive:!0,fullWidth:!0,onChange:r,children:Object.entries(ne).map((function(e){var t=Object(h.a)(e,2),n=t[0],i=t[1],c=i.icon,r=i.label;return Object(O.jsxs)(Z.a,{value:n,sx:{justifyContent:"flex-start",alignItems:"center"},children:[c,Object(O.jsx)(M.a,{variant:"caption",sx:{ml:1},children:r})]},n)}))}),Object(O.jsx)(M.a,{variant:"caption",sx:{mt:1},children:"\u63cf\u753b\u30c4\u30fc\u30eb"}),Object(O.jsx)(Y.a,{orientation:"vertical",value:n.eraser?"eraser":"pen",exclusive:!0,fullWidth:!0,disabled:"select"===t,onChange:a,children:Object.entries(ie).map((function(e){var t=Object(h.a)(e,2),n=t[0],i=t[1],c=i.icon,r=i.label;return Object(O.jsxs)(Z.a,{value:n,sx:{justifyContent:"flex-start",alignItems:"center"},children:[c,Object(O.jsx)(M.a,{variant:"caption",sx:{ml:1},children:r})]},n)}))}),Object(O.jsx)(M.a,{variant:"caption",sx:{mt:1},children:"\u592a\u3055"}),Object(O.jsx)($.a,{sx:{ml:1,mb:2,boxSizing:"border-box",width:140},value:n.strokeWidth,min:4,max:20,step:4,marks:!0,valueLabelDisplay:"auto",disabled:"select"===t,onChange:s}),Object(O.jsx)(ee.a,{type:"color",label:"\u30da\u30f3\u306e\u8272",value:n.stroke,disabled:"select"===t||n.eraser,fullWidth:!0,margin:"dense",size:"small",onChange:b})]})},re=function(){var e=Object(o.useContext)(k);return Object(O.jsx)(ce,Object(g.a)({},e))},ae=function(){var e=Object(o.useState)({width:0,height:0}),t=Object(h.a)(e,2),n=t[0],i=t[1],c=Object(o.useCallback)((function(){var e=window,t=e.innerHeight,n=e.innerWidth;i({height:t,width:n})}),[]);return Object(o.useEffect)((function(){return c(),window.addEventListener("resize",c),function(){window.removeEventListener("resize",c)}}),[c]),Object(O.jsxs)(y.a,{sx:Object(g.a)(Object(g.a)({},n),{},{overflow:"hidden"}),children:[Object(O.jsx)(R,{}),Object(O.jsxs)(y.a,{sx:{boxSizing:"border-box",width:"auto",height:"calc(100% - 48px)",display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",pt:1,px:1},children:[Object(O.jsx)(re,{}),Object(O.jsx)(q,{})]})]})},oe=Object(j.a)(),se=function(){return Object(O.jsx)(l.a,{theme:oe,children:Object(O.jsx)(x,{children:Object(O.jsxs)(S,{children:[Object(O.jsx)(d.a,{}),Object(O.jsx)(ae,{})]})})})},be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,154)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),c(e),r(e),a(e)}))};u.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(se,{})}),document.getElementById("root")),be()}},[[97,1,2]]]);
//# sourceMappingURL=main.b0304b86.chunk.js.map